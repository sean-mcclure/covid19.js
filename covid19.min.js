/*! covid19.js v1.1.1 | (c) | Created by Sean McClure - MIT License */
covid={urls:urls={countries:"https://raw.githubusercontent.com/coviddata/coviddata/master/docs/v1/countries/stats_pretty.json",regions:"https://raw.githubusercontent.com/coviddata/coviddata/master/docs/v1/regions/stats_pretty.json",places:"https://raw.githubusercontent.com/coviddata/coviddata/master/docs/v1/places/stats_pretty.json",fips:"https://collaboratescience.com/covid19/fips.json",country_codes:"https://collaboratescience.com/covid19/country_codes.json"},dynamo_load:function(e){var t=document.createElement("script");t.src=e,document.head.appendChild(t)},fetch_data:function(e,t){fetch(t).then(e=>e.text()).then(t=>{covid[e]=JSON.parse(t)})},fetch_all_data:function(){Object.values(covid.urls).forEach(function(e,t){covid.fetch_data(Object.keys(covid.urls)[t],e)})},cap_first_letter:function(e){var t=[];return e.split(" ").forEach(function(e){t.push(e.charAt(0).toUpperCase()+e.substring(1))}),t.join(" ")},dynamic_sort:function(e,t){if(void 0===t)var i=-1;if("ascending"===t)i=1;if("descending"===t)i=-1;return"-"===e[0]&&(i=-1,e=e.substr(1)),function(t,o){return(t[e]<o[e]?-1:t[e]>o[e]?1:0)*i}},get_time_series_countries:function(e="cumulative",t="cases",i="Canada"){var o=[];return covid.countries.forEach(function(r){r.country.name===covid.cap_first_letter(i)&&Object.keys(r.dates).forEach(function(i,c){var n={};n.date=i,n.value=Object.values(r.dates)[c][e][t],o.push(n)})}),o},get_time_series_regions:function(e="cumulative",t="cases",i="Ontario"){var o=[];return covid.regions.forEach(function(r){r.region.name===covid.cap_first_letter(i)&&Object.keys(r.dates).forEach(function(i,c){var n={};n.date=i,n.value=Object.values(r.dates)[c][e][t],o.push(n)})}),o},get_time_series_fips:function(e="cumulative",t="cases",i="36061"){var o=[],r=covid.get_place_from_fips(i)[0].place,c=covid.get_place_from_fips(i)[0].Province_State;return covid.places.forEach(function(i){i.place.name.includes(covid.cap_first_letter(r))&&i.place.region.name.includes(covid.cap_first_letter(c))&&Object.keys(i.dates).forEach(function(r,c){var n={};n.date=r,n.value=Object.values(i.dates)[c][e][t],o.push(n)})}),o},get_time_series:function(e,t,i){var o;return covid.get_all_countries().includes(covid.cap_first_letter(i))&&(o=covid.get_time_series_countries(e,t,i)),covid.get_all_regions().includes(covid.cap_first_letter(i))&&(o=covid.get_time_series_regions(e,t,i)),covid.get_all_fips().includes(covid.cap_first_letter(i))&&(o=covid.get_time_series_fips(e,t,i)),o},get_time_series_multiple:function(e="cumulative",t="cases",i=["Germany","Italy","France","United Kingdom"]){if(covid.get_all_countries().includes(covid.cap_first_letter(i[0]))){var o={};i.forEach(function(i){o[i]=covid.get_time_series(e,t,i)})}if(covid.get_all_regions().includes(covid.cap_first_letter(i[0]))){o={};i.forEach(function(i){o[i]=covid.get_time_series(e,t,i)})}if(covid.get_all_fips().includes(covid.cap_first_letter(i[0]))){o={};i.forEach(function(i){o[i]=covid.get_time_series_fips(e,t,i)})}return o},get_time_series_multiple_sum:function(e="cumulative",t="cases",i=["Germany","Italy","France","United Kingdom"]){var o={},r=[];Object.values(covid.get_time_series_multiple("cumulative","cases",i)).forEach(function(e){e.forEach(function(e){r.includes(e.date)?o[e.date].push(e.value):o[e.date]=[e.value],r.push(e.date)})});var c={};return Object.values(o).forEach(function(e,t){c[Object.keys(o)[t]]=e.reduce((e,t)=>e+t,0)}),c},check_if_country:function(e){return!!covid.get_all_countries().includes(e)},check_if_region:function(e){return!!covid.get_all_regions().includes(e)},get_all_countries:function(){var e=[];return covid.countries.forEach(function(t){e.push(t.country.name)}),e},get_all_regions:function(){var e=[];return covid.regions.forEach(function(t){e.push(t.region.name)}),e},get_all_places:function(){var e=[];return covid.places.forEach(function(t){e.push(t.place.name)}),e},get_all_fips:function(){var e=[];return covid.fips.forEach(function(t){e.push(t.FIPS)}),e},get_location_report:function(e){var t={};return["cases","deaths","recoveries"].forEach(function(i){var o=[];void 0!==covid.get_time_series("new",i,e)&&covid.get_time_series("new",i,e).forEach(function(e){o.push(e.value)}),t[i]=o.reduce((e,t)=>e+t,0)}),t},get_global_report:function(){var e=[];covid.get_all_countries().forEach(function(t){e.push(covid.get_location_report(t))});var t=[],i=[],o=[];e.forEach(function(e){t.push(e.cases),i.push(e.deaths),o.push(e.recoveries)});var r=t.reduce((e,t)=>e+t,0),c=i.reduce((e,t)=>e+t,0),n=o.reduce((e,t)=>e+t,0),s={};return s.cases=r,s.deaths=c,s.recoveries=n,s},sort_reports_by_type:function(e,t){var i=[];return covid.get_all_countries().forEach(function(e){this_report=covid.get_location_report(e),this_report.location=e,i.push(this_report)}),Object.values(i).sort(covid.dynamic_sort(e,t))},check_if_location_in_data:function(e){return res=!1,covid.get_all_countries().includes(covid.cap_first_letter(e))||covid.get_all_regions().includes(covid.cap_first_letter(e))?res=!0:res=!1,res},get_available_dates:function(){return Object.keys(covid.countries[0].dates)},get_countries_and_regions:function(){var e=[];return covid.regions.forEach(function(t){var i={};i.country=t.region.country.name,i.region=t.region.name,e.push(i)}),e},get_country_from_region:function(e){var t="";return covid.get_countries_and_regions().forEach(function(i){i.region===covid.cap_first_letter(e)&&(t=i.country)}),t},get_regions_from_country:function(e){var t=[];return covid.get_countries_and_regions().forEach(function(i){i.country===covid.cap_first_letter(e)&&t.push(i.region)}),t},check_if_country_has_region:function(e){var t=!1;return covid.get_regions_from_country(e).length>0&&(t=!0),t},find_code_by_country:function(e){var t=!1;return covid.country_codes.forEach(function(i){i.Country.includes(covid.cap_first_letter(e.split(" ")[0].trim()))&&(t=i.country_code)}),t},find_code_by_region:function(e){var t=!1,i=covid.get_country_from_region(e);return covid.country_codes.forEach(function(e){e.Country.includes(covid.cap_first_letter(i))&&(t=e.country_code)}),t},get_flag_url:function(e){return"https://collaboratescience.com/corona/flags/"+e+".png"},get_country_flag:function(e){if(covid.check_if_country(covid.cap_first_letter(e)))var t=covid.find_code_by_country(covid.cap_first_letter(e));else t=covid.find_code_by_region(covid.cap_first_letter(e));return covid.get_flag_url(t.toLowerCase())},get_fips_from_place:function(e){var t=[];return covid.fips.forEach(function(i){if(i.Admin2===covid.cap_first_letter(e)){var o={};o.FIPS=i.FIPS,o.Province_State=i.Province_State,t.push(o)}}),t},get_place_from_fips:function(e){var t=[];return covid.fips.forEach(function(i){if(i.FIPS===e){var o={};o.FIPS=i.FIPS,o.place=i.Admin2,o.Province_State=i.Province_State,o.Country_Region=i.Country_Region,t.push(o)}}),t},call_callback:function(e){},call_once_satisfied:function call_once_satisfied(props){eval(props.condition)?"function"==typeof props.function?covid.call_callback(props.function()):eval(props.function):setTimeout(function(){call_once_satisfied(props)},100)},run_sir_model:function(e=.1,t=.05){return run_sir(e,t)},run_regression_on_time_series:function(e,t){var i={},o=[];e.forEach(function(e,t){var i=[];i.push(t),i.push(e.value),o.push(i)}),"linear"===t&&(regression_results=methods.linear(o,{order:2,precision:2,period:null})),"exponential"===t&&(regression_results=methods.exponential(o,{order:2,precision:2,period:null})),"logarithmic"===t&&(regression_results=methods.logarithmic(o,{order:2,precision:2,period:null})),"power"===t&&(regression_results=methods.power(o,{order:2,precision:2,period:null})),"polynomial"===t&&(regression_results=methods.polynomial(o,{order:2,precision:2,period:null}));var r=[];return regression_results.points.forEach(function(e){var t={};t.index=e[0],t.value=e[1],r.push(t)}),i.predicted_results=r,i.r_squared=regression_results.r2,i.equation=regression_results.string,i.predict=regression_results.predict,i}},covid.fetch_all_data(),covid.dynamo_load("https://collaboratescience.com/covid19/sir_bundle.js"),covid.dynamo_load("https://collaboratescience.com/covid19/regression_bundle.js"),covid.is_ready=!1,covid.call_once_satisfied({condition:"typeof(covid.countries) !== 'undefined' && typeof(covid.regions) !== 'undefined' && typeof(covid.places) !== 'undefined' && typeof(covid.fips) !== 'undefined' && typeof(covid.country_codes) !== 'undefined'",function:function(){covid.is_ready=!0}});