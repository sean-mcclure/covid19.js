/*! covid19.js v1.1.1 | (c) | Created by Sean McClure - MIT License */
covid={urls:urls={countries:"https://raw.githubusercontent.com/coviddata/coviddata/master/docs/v1/countries/stats_pretty.json",regions:"https://raw.githubusercontent.com/coviddata/coviddata/master/docs/v1/regions/stats_pretty.json",places:"https://raw.githubusercontent.com/coviddata/coviddata/master/docs/v1/places/stats_pretty.json",fips:"https://collaboratescience.com/covid19/fips.json",country_codes:"https://collaboratescience.com/covid19/country_codes.json"},dynamo_load:function(e){var t=document.createElement("script");t.src=e,document.head.appendChild(t)},fetch_data:function(e,t){fetch(t).then(e=>e.text()).then(t=>{covid[e]=JSON.parse(t)})},fetch_all_data:function(){Object.values(covid.urls).forEach(function(e,t){covid.fetch_data(Object.keys(covid.urls)[t],e)})},cap_first_letter:function(e){var t=[];return e.split(" ").forEach(function(e){t.push(e.charAt(0).toUpperCase()+e.substring(1))}),t.join(" ")},dynamic_sort:function(e,t){if(void 0===t)var o=-1;if("ascending"===t)o=1;if("descending"===t)o=-1;return"-"===e[0]&&(o=-1,e=e.substr(1)),function(t,i){return(t[e]<i[e]?-1:t[e]>i[e]?1:0)*o}},get_time_series_countries:function(e="cumulative",t="cases",o="Canada"){var i=[];return covid.countries.forEach(function(r){r.country.name===covid.cap_first_letter(o)&&Object.keys(r.dates).forEach(function(o,c){var n={};n.date=o,n.value=Object.values(r.dates)[c][e][t],i.push(n)})}),i},get_time_series_regions:function(e="cumulative",t="cases",o="Ontario"){var i=[];return covid.regions.forEach(function(r){r.region.name===covid.cap_first_letter(o)&&Object.keys(r.dates).forEach(function(o,c){var n={};n.date=o,n.value=Object.values(r.dates)[c][e][t],i.push(n)})}),i},get_time_series_fips:function(e="cumulative",t="cases",o="36061"){var i=[],r=covid.get_place_from_fips(o)[0].place,c=covid.get_place_from_fips(o)[0].Province_State;return covid.places.forEach(function(o){o.place.name.includes(covid.cap_first_letter(r))&&o.place.region.name.includes(covid.cap_first_letter(c))&&Object.keys(o.dates).forEach(function(r,c){var n={};n.date=r,n.value=Object.values(o.dates)[c][e][t],i.push(n)})}),i},get_time_series:function(e,t,o){var i;return covid.get_all_countries().includes(covid.cap_first_letter(o))&&(i=covid.get_time_series_countries(e,t,o)),covid.get_all_regions().includes(covid.cap_first_letter(o))&&(i=covid.get_time_series_regions(e,t,o)),covid.get_all_fips().includes(covid.cap_first_letter(o))&&(i=covid.get_time_series_fips(e,t,o)),i},get_time_series_multiple:function(e="cumulative",t="cases",o=["Germany","Italy","France","United Kingdom"]){if(covid.get_all_countries().includes(covid.cap_first_letter(o[0]))){var i={};o.forEach(function(o){i[o]=covid.get_time_series(e,t,o)})}if(covid.get_all_regions().includes(covid.cap_first_letter(o[0]))){i={};o.forEach(function(o){i[o]=covid.get_time_series(e,t,o)})}if(covid.get_all_fips().includes(covid.cap_first_letter(o[0]))){i={};o.forEach(function(o){i[o]=covid.get_time_series_fips(e,t,o)})}return i},get_time_series_multiple_sum:function(e="cumulative",t="cases",o=["Germany","Italy","France","United Kingdom"]){var i={},r=[];Object.values(covid.get_time_series_multiple("cumulative","cases",o)).forEach(function(e){e.forEach(function(e){r.includes(e.date)?i[e.date].push(e.value):i[e.date]=[e.value],r.push(e.date)})});var c={};return Object.values(i).forEach(function(e,t){c[Object.keys(i)[t]]=e.reduce((e,t)=>e+t,0)}),c},get_all_growth_rates_country:function(e,t){var o={};return covid.get_all_countries().forEach(function(i){var r=covid.get_time_series(e,t,i),c=covid.run_regression_on_time_series(r,"exponential"),n=Number(/\(([^)]+)\)/.exec(c.equation)[1].replace("x",""));isNaN(n)||(o[i]=n)}),covid.sort_object(o)},check_if_country:function(e){return!!covid.get_all_countries().includes(e)},check_if_region:function(e){return!!covid.get_all_regions().includes(e)},get_all_countries:function(){var e=[];return covid.countries.forEach(function(t){e.push(t.country.name)}),e},get_all_regions:function(){var e=[];return covid.regions.forEach(function(t){e.push(t.region.name)}),e},get_all_places:function(){var e=[];return covid.places.forEach(function(t){e.push(t.place.name)}),e},get_all_fips:function(){var e=[];return covid.fips.forEach(function(t){e.push(t.FIPS)}),e},get_location_report:function(e){var t={};return["cases","deaths","recoveries"].forEach(function(o){var i=[];void 0!==covid.get_time_series("new",o,e)&&covid.get_time_series("new",o,e).forEach(function(e){i.push(e.value)}),t[o]=i.reduce((e,t)=>e+t,0)}),t},get_global_report:function(){var e=[];covid.get_all_countries().forEach(function(t){e.push(covid.get_location_report(t))});var t=[],o=[],i=[];e.forEach(function(e){t.push(e.cases),o.push(e.deaths),i.push(e.recoveries)});var r=t.reduce((e,t)=>e+t,0),c=o.reduce((e,t)=>e+t,0),n=i.reduce((e,t)=>e+t,0),s={};return s.cases=r,s.deaths=c,s.recoveries=n,s},sort_reports_by_type:function(e,t){var o=[];return covid.get_all_countries().forEach(function(e){this_report=covid.get_location_report(e),this_report.location=e,o.push(this_report)}),Object.values(o).sort(covid.dynamic_sort(e,t))},check_if_location_in_data:function(e){return res=!1,covid.get_all_countries().includes(covid.cap_first_letter(e))||covid.get_all_regions().includes(covid.cap_first_letter(e))?res=!0:res=!1,res},sort_object:function(e){return items=Object.keys(e).map(function(t){return[t,e[t]]}),items.sort(function(e,t){return t[1]-e[1]}),sorted_obj={},Object.keys(items).forEach(function(e,t){use_key=Object.values(items)[t][0],use_value=Object.values(items)[t][1],sorted_obj[use_key]=use_value}),sorted_obj},get_available_dates:function(){return Object.keys(covid.countries[0].dates)},get_countries_and_regions:function(){var e=[];return covid.regions.forEach(function(t){var o={};o.country=t.region.country.name,o.region=t.region.name,e.push(o)}),e},get_country_from_region:function(e){var t="";return covid.get_countries_and_regions().forEach(function(o){o.region===covid.cap_first_letter(e)&&(t=o.country)}),t},get_regions_from_country:function(e){var t=[];return covid.get_countries_and_regions().forEach(function(o){o.country===covid.cap_first_letter(e)&&t.push(o.region)}),t},check_if_country_has_region:function(e){var t=!1;return covid.get_regions_from_country(e).length>0&&(t=!0),t},find_code_by_country:function(e){var t=!1;return covid.country_codes.forEach(function(o){o.Country.includes(covid.cap_first_letter(e.split(" ")[0].trim()))&&(t=o.country_code)}),t},find_code_by_region:function(e){var t=!1,o=covid.get_country_from_region(e);return covid.country_codes.forEach(function(e){e.Country.includes(covid.cap_first_letter(o))&&(t=e.country_code)}),t},get_flag_url:function(e){return"https://collaboratescience.com/corona/flags/"+e+".png"},get_country_flag:function(e){if(covid.check_if_country(covid.cap_first_letter(e)))var t=covid.find_code_by_country(covid.cap_first_letter(e));else t=covid.find_code_by_region(covid.cap_first_letter(e));return covid.get_flag_url(t.toLowerCase())},get_fips_from_place:function(e){var t=[];return covid.fips.forEach(function(o){if(o.Admin2===covid.cap_first_letter(e)){var i={};i.FIPS=o.FIPS,i.Province_State=o.Province_State,t.push(i)}}),t},get_place_from_fips:function(e){var t=[];return covid.fips.forEach(function(o){if(o.FIPS===e){var i={};i.FIPS=o.FIPS,i.place=o.Admin2,i.Province_State=o.Province_State,i.Country_Region=o.Country_Region,t.push(i)}}),t},call_callback:function(e){},call_once_satisfied:function call_once_satisfied(props){eval(props.condition)?"function"==typeof props.function?covid.call_callback(props.function()):eval(props.function):setTimeout(function(){call_once_satisfied(props)},100)},run_sir_model:function(e=.1,t=.05){return run_sir(e,t)},run_regression_on_time_series:function(e,t){var o={},i=[];void 0!==e&&e.forEach(function(e,t){var o=[];o.push(t),o.push(e.value),i.push(o)}),"linear"===t&&(regression_results=methods.linear(i,{order:2,precision:2,period:null})),"exponential"===t&&(regression_results=methods.exponential(i,{order:2,precision:2,period:null})),"logarithmic"===t&&(regression_results=methods.logarithmic(i,{order:2,precision:2,period:null})),"power"===t&&(regression_results=methods.power(i,{order:2,precision:2,period:null})),"polynomial"===t&&(regression_results=methods.polynomial(i,{order:2,precision:2,period:null}));var r=[];return regression_results.points.forEach(function(e){var t={};t.index=e[0],t.value=e[1],r.push(t)}),o.predicted_results=r,o.r_squared=regression_results.r2,o.equation=regression_results.string,o.predict=regression_results.predict,o}},covid.fetch_all_data(),covid.dynamo_load("https://collaboratescience.com/covid19/sir_bundle.js"),covid.dynamo_load("https://collaboratescience.com/covid19/regression_bundle.js"),covid.is_ready=!1,covid.call_once_satisfied({condition:"typeof(covid.countries) !== 'undefined' && typeof(covid.regions) !== 'undefined' && typeof(covid.places) !== 'undefined' && typeof(covid.fips) !== 'undefined' && typeof(covid.country_codes) !== 'undefined'",function:function(){covid.is_ready=!0}});